<!-- 
Introductory text to include in both the cell type section of main report and at
the top of the supplemental cell type report.

All chunks in this document must be set to `eval=FALSE`.
-->


```{r available_celltypes_text, eval=FALSE}

# build up this string as we go:
methods_text <- ""

if (has_submitter) {
  methods_text <- glue::glue(
    "{methods_text}
    * Cell type annotations were provided by the original lab (`submitter-provided`) which generated this data.\n\n"
  )
}

if (has_singler) {
  
  methods_text <- glue::glue(
    "{methods_text}
    * Cell types were annotated using [`SingleR`](https://bioconductor.org/packages/release/bioc/html/SingleR.html), which uses a reference-based approach ([Looney _et al._ 2019](https://doi.org/10.1038/s41590-018-0276-y)).
    The `{metadata(processed_sce)$singler_reference}` reference dataset, obtained from the [`celldex` package](http://bioconductor.org/packages/release/data/experiment/html/celldex.html), was used for cell typing.\n\n"
    )
}

if (has_cellassign) {

  # TODO: UPDATE THIS STRING WRANGLING WHEN NAMING CHANGES???
  tissue_type <- stringr::word(
    metadata(processed_sce)$cellassign_reference,
    -1,
    sep = "-"
  )
  
  methods_text <- glue::glue(
    "{methods_text}
    * Cell types were annotated using [`CellAssign`](https://github.com/Irrationone/cellassign), which uses a marker-gene based approach ([Zhang _et al._ 2019](https://doi.org/10.1038/s41592-019-0529-1)).
    Marker genes associated with `{tissue_type}` tissue were obtained from [PanglaoDB](https://panglaodb.se/).\n
    "
  )
}


glue::glue("
<div class=\"alert alert-info\">

{methods_text}

</div>
") 
```



